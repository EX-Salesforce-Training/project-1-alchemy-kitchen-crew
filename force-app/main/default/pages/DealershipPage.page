<apex:page controller="DealershipController" lightningStylesheets="true">
    <apex:slds />
     <style type="text/css">
          .bPageBlock{
       background: #B0E0E6 !important ;
        }
         .column:hover {
            colour: black;
         }
         
        .column {
         background-color: blanchedalmond;
         }
     
        .newheader {
         font-size:300%;
         font-weight:bold;
         text-align:center;
         }
        
    </style >
    <apex:form styleClass="DealerForm" >
        <apex:pageBlock mode="maindetail">
            
            <!-- Header for the Table -->
            
            <div class="newheader">            
                <h1 >
                    Dealerships and Top Opportunity
                </h1>
            </div>
            
            <!--Table to display the Dealerships and the top Open Opportunity(by amount) for each Dealership from the wrapper class-->
            
                <apex:pageBlockTable value="{!wrappedDealers}" var="wrapped" id="Dealers" styleClass="table"> 
                        <apex:column headerValue="Dealership Name" styleClass="column">
                            <!-- using commandlink to populate the table below -->
                                <apex:commandLink action="{!changeDealer}" value="{!wrapped.wrappedDealer.Name}" reRender="opps" styleClass="columnTitle">
                                    <apex:param name="dParam" value="{!wrapped.wrappedDealer.Name}" assignTo="{!currentDealerName}"/>
                                </apex:commandLink>
                        </apex:column>
                    <apex:column headerValue="Dealership City" styleClass="column">
                        <apex:outputField styleClass="columnTitle" value="{!wrapped.wrappedDealer.City__c}"/>
                    </apex:column>

                    <apex:column headerValue="Dealership State" styleClass="column">
                        <apex:outputField styleClass="columnTitle" value="{!wrapped.wrappedDealer.State__c}" />
                    </apex:column>
                    <apex:column headerValue="Top Opportunity Name" styleClass="column">
                        <apex:outputField value="{!wrapped.topOpp.Name}" />
                    </apex:column>
                    <apex:column headerValue="Top Opportunity Amount"  styleClass="column">
                        <apex:outputField value="{!wrapped.topOpp.Amount}" />
                    </apex:column>
                    <apex:outputField />
                </apex:pageBlockTable>
            
        </apex:pageBlock> 
        <div   class="oppsTable" >
            
            <!--Table to show All Open Opportunites for a specific Dealership clicked from the above table(can only click name) -->
            <apex:pageBlock title="Open Opportunities for {!currentDealerName}" id="opps">
               
                    <apex:pageBlockTable value="{!currentDealerOpportunities}" var="opp" styleClass="table" >
                        <apex:column headerValue="Opportunity Name" styleClass="column" >
                            <apex:outputField value="{!opp.Name}" />
                        </apex:column>
                        <apex:column headerValue="Opportunity Amount" styleClass="column">
                            <apex:outputField value="{!opp.Amount}" />
                        </apex:column>
                        <apex:column headerValue="Opportunity Close Date" styleClass="column">
                            <apex:outputField value="{!opp.CloseDate}" />
                        </apex:column>
                        <apex:column headerValue="Opportunity Stage" styleClass="column">
                            <apex:outputField value="{!opp.StageName}" />
                        </apex:column>
                    </apex:pageBlockTable>
               
            </apex:pageBlock>
        </div>
    </apex:form>
</apex:page>